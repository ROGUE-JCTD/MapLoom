language: node_js
node_js:
  - '0.12'
  - '0.10'
addons:
  code_climate:
    repo_token:
      secure: i7X0pPBPIH+bTZykwLIXw4cTjIK0O38e0/qYfRKZdtv8R5oZnrTYUCkWzSK7q4l85RpC/aFCmx8etmfCSxSfTCx5lq3Fg1yU66c7CoGExLAZxcVdibnrFCp9KdXAwzlUIlaZ3hisBmskRLdQMSzi57Ld8JTrE4wW68g5QL08qHkpKTtoyHgkRnmc4shQqyZbAXvPvWN3F7VKe8J0Cctkj9cdt1zfM/g3J2wT7x/uoLJmuWZaJms65pAuxfOIix8L6T6aWMZkXSXbrHa9buKregYdmH9HhTh5937DHCqXWMi0t4CpCl6NlXOeaz0gjytanGUgkw96qjP+1lw7NM1d1GyOBdpmqkNdqpBaTLj22qZfkQaqxTy29rYA2laAOJjDwTWId1WuzuW8DIq5byDFSKQjGEcREWbnS9XHZQaBJdT6HD1UjaYaTESW68HNv7e1mOhVIit0MQzhjINxXajuptwwfs3sU2mJc303WmmPRnIXjfYewk8coTCHtDm9Ar6wKuET2zDkSQSMohQOd4KhZcn3X0FWGssvegd80YuTz/4dUUuPKgEdGUcFXmjfxuAeI3pg2Qihdxwr9/Jkc/7Dk4OlZPZnr90kYPi9/aaGDglIyLbWcu6RNmqxhlVY2+LOR/k3UxyhV4Zs2i0lW2E5Q6/qJ0v1fMC/WfKJrzA/Jxk=
before_script:
  - export DISPLAY=:99.0
  - sh -e /etc/init.d/xvfb start
  - npm install --quiet -g grunt-cli karma bower codeclimate-test-reporter
  - bower install
  - grunt
  - grunt karmaconfig
script: grunt test
env:
  matrix:
    - DEPLOY_BRANCH=hypermap
  global:
    secure: HppnhZMk+tZvDsuPelDnjfnKTH4hhHepElR8fNpOscEy5cpWQKb4BWmayw6rsfIvF5E36P5uL7sGyDsc0QVf0XvarX3CrHBZ0oZC/1rS5P9EXVJAPSsKpsNuN55JDtPL1eq7AC5NvP1kfWPQNVqWjmbQt5c6FBgm3dfvLUCD7YYthIEUoFwErmnLrWRXzdB4rFNF3BZa8sJ8/u6/meNPoqKjcWVLcbHLBOmc1pG51bSD+PYFjhYZLOqQfuI6Ix23isClhIGcWeENt/4jPHjQlVX6aivwmvIZ4ioK6iQQopEbq/VV9ACkgY1Q80zCcRwsTFPS6fAjAy4PVcFytSfF3wBoBjJmUM4qv9YJn9axx8rGeIVkORyU3RNT/sbZpeQfiB6hd1WpWeI4G8iXNHwgUjjF0FteXMHqrQOzy8UhG+eLIIpOhZe7mvNxlx0PvSQaIPoVtgU6dlJrAmZ3mLPtqomF9if/my1/zN5XaiJo2JGvwcNKHN8A25XBM1S1xaovra8L5eH3SSAOPTN/MvxJWlJqlOyRxbi9lCJdGw6Dacem3iqvCED/1QZYPbfSINV/f7WM4JUDOSAttHvt1mf4m8uhGM0sWXTZok/AIOx7Xe8Qh55TYyLr+Nx9F/vNDEQbN+vWpbrRg+SPosW8B1hWI1Q2rJRfLwS5GU2EwfY0BV8=
after_success:
  - grunt deploy
after_script:
  - codeclimate-test-reporter < reports/coverage/lcov.info
